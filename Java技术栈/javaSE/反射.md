> 反射允许对成员变量，成员方法和构造方法的信息进行编程访问

## 1、获取class对象的三种方式

1. Class.forName(“全类名”)
2. 类名.class
3. 对象.getClass()

## 2、获取构造方法

getConstructor(Class<?>...parameterTypes):获取单个公共构造方法

getDeclaredConstructor(Class...parameterTypes):获取单个构造方法

getConstructors():获取所有公共构造方法数组

getDeclaredConstructors():获取所有构造方法数组

```java
Class<User> clazz = User.class;
Constructor<?>[] constructors = clazz.getDeclaredConstructors();
for (Constructor<?> constructor : constructors) {
  System.out.println(constructor);
}
```

### 通过Constructor类创建对象

T.newInstance(Object...initargs):根据指定构造方法创建对象

setAccessible(boolean flag):设置为true,取消访问检查

```java
Class<User> clazz = User.class;
Constructor<User> constructor = clazz.getDeclaredConstructor(String.class, Integer.class);
User user = constructor.newInstance("张三", 18);
```

## 3、获取成员变量

getField(String name):获取单个公共成员变量对象

getDeclaredField(String name):获取单个成员变量对象

getFields():获取所有公共成员变量数组

getDeclaredFields():获取所有成员变量数组

```java
Class<User> clazz = User.class;
//所有成员变量
Field[] declaredFields = clazz.getDeclaredFields();
for (Field field : declaredFields) {
  System.out.println(field.getName());
}
//变量为name的成员变量
Field name = clazz.getDeclaredField("name");
System.out.println(name);
```

### Field类中创建对象的方法

void set(Object obj,Object value):赋值

Object get(Object obj):获取值

```java
HashMap<String, Object> map = new HashMap<>();
User user = new User("张三", 18);
Class<? extends User> clazz = user.getClass();
for (Field field: clazz.getDeclaredFields()){
  //私有属性可访问
  field.setAccessible(true);
  //获取变量值
  map.put(field.getName(),field.get(user));
}
map.keySet().forEach(key->{
  System.out.println(key+"-->"+map.get(key));
});
```

## 3、获取成员方法

getMethod(String name,Class<?>...parameterType):获取公共成员方法

getDeclaredMethod(String name,Class<?>...parameterType):获取成员方法

getMethods():获取所有公共成员方法数组,包括继承的

getDeclaredMethods():获取所有公共成员方法,不包括继承的

```java
Class<User> clazz = User.class;
//获取所有成员方法
Method[] declaredMethods = clazz.getDeclaredMethods();
for (Method method : declaredMethods) {
  System.out.println(method.getName());
}
//获取方法名为say()的有参方法
Method say = clazz.getDeclaredMethod("say", String.class);
System.out.println(say);
```

### Method类中创建对象的方法

Object invoke(Object obj,Object...args):运行方法

参数一:用obj对象调用该方法

参数二:调用方法的传递的参数，没有就不写

方法返回值:没有就不写

`User`类

```java
public class User {
    private String name;
    private Integer age;
    private String say(String name){
        return "hello world"+name;
    }
    public User (){

    }
    public User (String name,Integer age){
        this.name = name;
        this.age = age;
    }
}
```

调用user的say()方法

```java
Class<User> clazz = User.class;
//创建user对象
Constructor<User> constructor = clazz.getConstructor();
User user = constructor.newInstance();
//获取say方法
Method say = clazz.getDeclaredMethod("say", String.class);
say.setAccessible(true);
//运行该对象方法
Object str = say.invoke(user, "张三");
System.out.println(str);
```

==结果:==hello world张三